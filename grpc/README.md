## grpc
### Prerequisites
1. Install Go: https://golang.org/doc/install
1. Install protoc : gRPC uses protobuf to communicate, in order to generate relevant files, you will need to install protoc :
```brew install protobuf``` // For MacOS
1. install protoc-gen-go : as we use go in this post, you will need the go-support for protobuf 
```go get -u github.com/golang/protobuf/protoc-gen-go```
1. install grpc : the grpc package for golang :
```go get -u google.golang.org/grpc```
(Note: make sure your GOPATH is correctly set up so that your packages and project will be under GOPATH/src )

NOTE: Incase ```protoc-gen-go``` command not found. Then include following to your ~/.bash_profile

```
export GO_PATH=~/go
export PATH=$PATH:/$GO_PATH/bin
```

### Generate protobuf file
1. generate protobuf file from myproto/greet.proto by executing 
```
protoc --go_out=plugins=grpc:. *.proto
```

### Server

1. Configure listener by 

```
addr := "127.0.0.1:8083"
lis, err := net.Listen("tcp", addr)
```
2. Create new server

```
s:=grpc.NewServer()
```

3. Register server to `RegisterMyServiceServer` which is auto generated by protobuf

4. Implement the func `MyGreetings` 


### Client

1. Client to configure grpc dial 
```
 cc,err:=grpc.Dial("localhost:8083",opt)
```
2. Dialing to port by 
```
client := mypro.NewMyServiceClient(cc)
```
3. Create request
```
req := &mypro.MyRequest{Name: "ashaik"}
```
4. Call server method
```
res, err := client.MyGreetings(context.Background(), req)
```


#### To make gRPC call through postman 

Configuration of the proxy and its dependencies is a three step process.
Register a JSON codec with the gRPC server. At Weave, this is as easy as using the most current version of our internal library. In Go, it can be automatically registered simple by adding the following import:
1. import _"github.com/jnewmano/grpc-json-proxy/codec"
2. Run the grpc-json-proxy.
go get -u github.com/jnewmano/grpc-json-proxy 
grpc-json-proxy
3. Configure Postman to send requests through the proxy.
Postman -> Preferences -> Proxy -> Global Proxy
Proxy Server: localhost 7001
4. Start server 
```go run server.go```
Server running on ... 127.0.0.1:8083

#### Postman request
1. Set request method to Post .
2. Set the URL to `http://{{ grpc server address}}/{{proto package}}.{{proto service}}/{{method}}` Always use http, proxy will establish a secure connection to the gRPC server.
3. Set the `Content-Type` header to `application/grpc+json` .
4. Optionally add a `Grpc-Insecure` header set to `true` for an insecure connection.
5. Set the request body to appropriate JSON for the message. For reference, generated Go code includes JSON tags on the generated message structs.

## REST vs gRPC

|Rest API | gRPC|
|---------|-----------|
| http 1.1| http/2|

